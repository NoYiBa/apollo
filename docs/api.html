<!DOCTYPE html><html><head><title>api - routes/api.js</title><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="https://highlightjs.org/static/styles/github.css"><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script src="https://highlightjs.org/static/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="container"><span class="help-inline"><a href="message-formatting.html">message-formatting.html</a></span>&nbsp;&nbsp;<span class="help-inline"><a href="api.html">api.html</a></span>&nbsp;&nbsp;<span class="help-inline"><a href="auth.html">auth.html</a></span>&nbsp;&nbsp;<hr><h3 class="help-block">routes/api.js</h3><hr><h1>api</h1><div id="api" class="comment"><p>Router attached at <code>/api</code>.</p>
<div></div><br></div><br><div id="-p-GET--me--p--" class="comment"><h3><a href="#-p-GET--me--p--" class="bold"><p>GET /me</p>
</a></h3><div><p>Get my Account. Also good for checking if you are logged in.</p>
</div><p><strong>returns&nbsp;<code>object Account || null</code></strong></p><br></div><br><div id="-p-PATCH--me--p--" class="comment"><h3><a href="#-p-PATCH--me--p--" class="bold"><p>PATCH /me</p>
</a></h3><div><p>Update my own account. All body properties are optional.</p>
</div><p><strong>returns&nbsp;<code>object Account</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>password</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>display</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>email</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>settings</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br></div><br><div id="-p-PUT--forgot--emailOrId--p--" class="comment"><h3><a href="#-p-PUT--forgot--emailOrId--p--" class="bold"><p>PUT /forgot/:emailOrId</p>
</a></h3><div><p>Forgot password.</p>
</div><p><strong>returns&nbsp;<code>object { message: &quot;&quot; }</code></strong></p><br></div><br><div id="-p-PUT--password-reset---id--conf--p--" class="comment"><h3><a href="#-p-PUT--password-reset---id--conf--p--" class="bold"><p>PUT /password-reset/:_id/:conf</p>
</a></h3><div><p>Reset password using confirmation token.</p>
</div><p><strong>returns&nbsp;<code>object Account</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>password</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br></div><br><div id="-p-GET--accounts--p--" class="comment"><h3><a href="#-p-GET--accounts--p--" class="bold"><p>GET /accounts</p>
</a></h3><div><p>List all accounts.</p>
</div><p><strong>returns&nbsp;<code>Array of Accounts</code></strong></p><br></div><br><div id="-p-GET--accounts--id--p--" class="comment"><h3><a href="#-p-GET--accounts--id--p--" class="bold"><p>GET /accounts/:id</p>
</a></h3><div><p>Fetch a specific account.</p>
</div><p><strong>returns&nbsp;<code>object Account</code></strong></p><br></div><br><div id="-p-DELETE--account--id--p--" class="comment"><h3><a href="#-p-DELETE--account--id--p--" class="bold"><p>DELETE /account/:id</p>
</a></h3><div><h4 id="todo-rework-this">TODO: rework this</h4>
<p>Remove an account. Does not delete all of their messages/files so may cause breakage or
orphan data.</p>
</div><p><strong>returns&nbsp;<code>object { message: &quot;&quot; }</code></strong></p><br></div><br><div id="-p-POST--accounts--p--" class="comment"><h3><a href="#-p-POST--accounts--p--" class="bold"><p>POST /accounts</p>
</a></h3><div><p>Create a new local account and kick off confirmation by email (if required by configuration).</p>
</div><p><strong>returns&nbsp;<code>object Account, { error: &quot;&quot; }</code></strong></p><p><strong>fires</strong><code>newaccount</code></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>_id</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The username and unique identifier and endpoint.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>email</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>display</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The display name for this user.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>password</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br></div><br><div id="-p-GET--groups--p--" class="comment"><h3><a href="#-p-GET--groups--p--" class="bold"><p>GET /groups</p>
</a></h3><div><p>List the groups this person can see. (currently all groups!)</p>
</div><p><strong>returns&nbsp;<code>Array of Groups</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>?ids=</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional comma separated list of ids only you are wanting to list.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?owner=</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional Account._id to limit only to that user's groups.</div></div><br class="visible-xs"><br></div><br><div id="-p-GET--groups--id--p--" class="comment"><h3><a href="#-p-GET--groups--id--p--" class="bold"><p>GET /groups/:id</p>
</a></h3><div><p>Get a specific group object by <code>_id</code>.</p>
</div><p><strong>returns&nbsp;<code>object Group || 404 { error: '' }</code></strong></p><br></div><br><div id="-p-POST--groups--p--" class="comment"><h3><a href="#-p-POST--groups--p--" class="bold"><p>POST /groups</p>
</a></h3><div><p>Create a new group. Forces you to be the owner.</p>
</div><p><strong>returns&nbsp;<code>object Group</code></strong></p><p><strong>fires</strong><code>newgroup</code></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>_id</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The group name.</div></div><br class="visible-xs"><br></div><br><div id="-p-DELETE--groups--p--" class="comment"><h3><a href="#-p-DELETE--groups--p--" class="bold"><p>DELETE /groups</p>
</a></h3><div><p>Remove a group by _id if you own it.</p>
</div><p><strong>returns&nbsp;<code>object Group</code></strong></p><p><strong>fires</strong><code>removegroup</code></p><br></div><br><div id="-p-PATCH--groups---id-owner--accountId--p--" class="comment"><h3><a href="#-p-PATCH--groups---id-owner--accountId--p--" class="bold"><p>PATCH /groups/:_id/owner/:accountId</p>
</a></h3><div><p>Change ownership of a group (param <code>_id</code>).</p>
<p>New owner is the <code>Account._id</code> in URL param <code>accountId</code>.</p>
</div><p><strong>returns&nbsp;<code>object Group</code></strong></p><br></div><br><div id="-p-GET--messages--p--" class="comment"><h3><a href="#-p-GET--messages--p--" class="bold"><p>GET /messages</p>
</a></h3><div><p>Fetch messages. Requires one or more querystring params to determine what you need.</p>
<p>Always sorts <em>descending by <code>created</code></em> (most recent are last).</p>
<p>The following properties are <strong>populated</strong> with the objects, instead of being
just an _id field:</p>
<ul>
<li><code>message.from</code></li>
<li><code>message.to</code></li>
<li><code>message.group</code></li>
</ul>
</div><p><strong>returns&nbsp;<code>Array of Messages</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>?ids=</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Comma separated list of `Message._id`s.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?group=</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">`Message.group` of the messages.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?account=</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Messages between the logged in user and another account.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?limit=50</code></div><div class="col-sm-3"><strong>number</strong></div><div class="col-sm-5">Integer; how many messages to fetch.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?skip=0</code></div><div class="col-sm-3"><strong>number</strong></div><div class="col-sm-5">Integer; how many messages to skip when fetching (descending order by created).</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>?before=</code></div><div class="col-sm-3"><strong>date</strong></div><div class="col-sm-5">Fetch messages that were created no later than this date.</div></div><br class="visible-xs"><br></div><br><div id="-p-POST--messages--p--" class="comment"><h3><a href="#-p-POST--messages--p--" class="bold"><p>POST /messages</p>
</a></h3><div><p>Create a message which persists it to the server.</p>
<p>Does not send it through Respoke as a web socket. That is done by the client.</p>
</div><p><strong>returns&nbsp;<code>object Message</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>to</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional Account._id for a private message.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>group</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional Group._id for a group message.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>content</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The message text.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>file</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional File._id that is considered related to this message.</div></div><br class="visible-xs"><br></div><br><div id="-p-POST--files--p--" class="comment"><h3><a href="#-p-POST--files--p--" class="bold"><p>POST /files</p>
</a></h3><div><p>Upload a file.</p>
</div><p><strong>returns&nbsp;<code>object File (model - not actual file)</code></strong></p><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>content</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The file as Base64 encoded string.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>contentType</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">MIME type of the file.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>owner</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">The Account._id of the logged in user uploading the file.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>name</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5">Optional file name.</div></div><br class="visible-xs"><br></div><br><div id="-p-GET--files---id--p--" class="comment"><h3><a href="#-p-GET--files---id--p--" class="bold"><p>GET /files/:_id</p>
</a></h3><div><p>Fetch an entire File document.</p>
<p>Get <em>only</em> the file by doing <code>GET /files/:_id</code>.</p>
</div><p><strong>returns&nbsp;<code>object File</code></strong></p><br></div><br></div></body><br><br><br><br><br><br><br></html>